{"version":3,"file":"src_app_pages_test_test_module_ts.js","mappings":"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","sources":["./src/app/pages/test/test-routing.module.ts","./src/app/pages/test/test.module.ts","./src/app/pages/test/test.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { TestPage } from './test.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: TestPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class TestPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { TestPageRoutingModule } from './test-routing.module';\n\nimport { TestPage } from './test.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    TestPageRoutingModule\n  ],\n  declarations: [TestPage]\n})\nexport class TestPageModule {}\n","/* eslint-disable @typescript-eslint/member-ordering */\n/* eslint-disable @typescript-eslint/naming-convention */\nimport { ChangeDetectorRef, Component, OnInit } from '@angular/core';\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { LoadingController } from '@ionic/angular';\nimport { Test } from 'src/app/models/course.interface';\nimport { CommonService } from 'src/app/services/common/common.service';\nimport { DataService } from 'src/app/services/data/data.service';\nimport { StateService } from 'src/app/services/state/state.service';\nimport { StorageService } from 'src/app/services/storage/storage.service';\nimport { saveAs } from 'file-saver';\nimport { Student } from 'src/app/models/student.interface';\n\n@Component({\n  selector: 'app-test',\n  templateUrl: './test.page.html',\n  styleUrls: ['./test.page.scss'],\n})\nexport class TestPage implements OnInit {\n\n  public test: Test = null;\n  private courseId: string;\n  private testId: string;\n  public student: Student;\n  public segment: string = 'content';\n\n  constructor(\n    private cd: ChangeDetectorRef,\n    private dataService: DataService,\n    private stateService: StateService,\n    private storageService: StorageService,\n    private loadingCtrl: LoadingController,\n    private commonService: CommonService,\n    private http: HttpClient\n  ) {\n    this.courseId = this.stateService.getData('course')?.id || '';\n    this.testId = this.stateService.getData('test')?.id || '';\n    this.dataService.getTestById(this.testId).subscribe((resp: any) => {\n      this.test = resp;\n      this.cd.detectChanges();\n    });\n    this.dataService.getStudentById(localStorage.getItem('student_id') || '').subscribe((resp: any) => {\n      this.student = resp[0];\n      localStorage.setItem('student', JSON.stringify(this.student));\n      this.cd.detectChanges();\n    });\n  }\n\n  ngOnInit() {\n  }\n\n  segmentChanged(event: any) {\n    console.log(event);\n  }\n\n  async fileSelected(event: any) {\n    const selectedFile: any = event.target.files[0];\n    const loading = await this.loadingCtrl.create({ message: 'Uploading answer' });\n    loading.present();\n    const file = {\n      file: selectedFile,\n      name: selectedFile.name\n    };\n    const upload: any = await this.storageService.uploadAnswer(file);\n    if (upload && upload.file_url) {\n      if (this.test.answers && this.test.answers.length > 0) {\n        this.test.answers.push({\n          file_url: upload.file_url,\n          type: this.commonService.getExtension(selectedFile.name),\n          name: selectedFile.name,\n          student_id: this.student.id,\n          student_name: this.student.first_name + ' ' + this.student.last_name\n        });\n      } else {\n        this.test.answers = [{\n          file_url: upload.file_url,\n          type: this.commonService.getExtension(selectedFile.name),\n          name: selectedFile.name,\n          student_id: this.student.id,\n          student_name: this.student.first_name + ' ' + this.student.last_name\n        }];\n      }\n      await this.dataService.updateTest(this.test);\n      loading.dismiss();\n    } else {\n      console.error('Error while uploading file:::::::::::\\n', upload);\n      loading.dismiss();\n    }\n  }\n\n  download(file: any) {\n\n    saveAs(file.file_url, file.name);\n\n    // const headers = new HttpHeaders()\n    //   .set('content-type', '*/*')\n    //   .set('Access-Control-Allow-Origin', '*')\n    //   .append('content-type', 'application/json');\n    // this.http.get(file.file_url, { headers }).subscribe((response) => {\n    //   console.log(response);\n    // });\n\n\n    // const xhr = new XMLHttpRequest();\n    // xhr.responseType = 'blob';\n    // xhr.onload = (event) => {\n    //   /* Create a new Blob object using the response\n    //   *  data of the onload object.\n    //   */\n    //   const blob = new Blob([xhr.response], {});\n    //   const a: any = document.createElement('a');\n    //   a.style = 'display: none';\n    //   document.body.appendChild(a);\n    //   const url = window.URL.createObjectURL(blob);\n    //   a.href = url;\n    //   a.download = file.name;\n    //   a.click();\n    //   window.URL.revokeObjectURL(url);\n    // };\n    // xhr.open('GET', file.file_url);\n    // xhr.send();\n\n\n\n\n    // const a = document.createElement('a');\n    // a.style.display = 'none';\n    // a.setAttribute('download', file.name);\n    // a.href = file.file_url;\n    // // the filename you want\n    // a.download = file.name;\n    // document.body.appendChild(a);\n    // a.click();\n    // a.remove();\n\n    // This can be downloaded directly:\n    // const xhr = new XMLHttpRequest();\n    // xhr.responseType = 'blob';\n    // xhr.onload = (event) => {\n    //   const blob = xhr.response;\n    // };\n    // xhr.open('GET', file.file_url);\n    // xhr.send();\n  }\n\n}\n"],"names":["ChangeDetectorRef","Component","HttpClient","LoadingController","CommonService","DataService","StateService","StorageService","saveAs","TestPage","constructor","cd","dataService","stateService","storageService","loadingCtrl","commonService","http","courseId","getData","id","testId","getTestById","subscribe","resp","test","detectChanges","getStudentById","localStorage","getItem","student","setItem","JSON","stringify","ngOnInit","segmentChanged","event","console","log","fileSelected","selectedFile","target","files","loading","create","message","present","file","name","upload","uploadAnswer","file_url","answers","length","push","type","getExtension","student_id","student_name","first_name","last_name","updateTest","dismiss","error","download","selector","template"],"sourceRoot":"webpack:///"}